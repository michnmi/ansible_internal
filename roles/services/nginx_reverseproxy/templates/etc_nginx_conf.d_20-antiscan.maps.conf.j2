# Generated by Ansible — cheap centralized anti-scan controls.

# Bad URIs from logs + common loot
map $uri $is_bad_uri {
    default 0;

    # Dotfiles (keep /.well-known for ACME)
    ~^/\.(?!well-known)                                   1;

    # .env variants & sensitive config
    ~*^/\.env(?:[\.\w-]*)?$                               1;
    ~*^/.+\.env(?:[\.\w-]*)?$                             1;
    ~*^/(?:aws|\.aws|aws-secret)\b.*                      1;
    ~*^/(?:\.travis\.yml|\.circleci/.*|\.vscode/.*)       1;

    # Generic config loot
    ~*^/(?:config|configs?|configuration|settings|parameters)(?:\.(?:js|json|ya?ml|php)|/.*)?$ 1;

    # Code / storage paths with sensitive extensions
    ~*^/(?:api|backend|admin|app|apps|core|shared|server|service|services|user|users|controller|controllers|helper|helpers|vendor|node|node_modules|public|storage|cloud|portal|website|dev|development|prod|production|local|new|laravel|crm|mail|mailer|nginx|docker|www)(?:/.*\.(?:env|ya?ml|json|js|php|py|sh))$ 1;

    # One-offs from sample
    ~*^/phpinfo(?:\.php)?$                                1;
    ~*^/info\.php$                                        1;
    ~*^/wp-config(?:\.php|)?$                             1;
    ~*^/metadatauploader$                                 1;
    ~*^/shell(?:\?|$)                                     1;
}

# Very “botty”/scanner UAs
map $http_user_agent $is_bad_ua {
    default 0;
    ~*(?:curl|python|httpx|wget|nikto|sqlmap|masscan|zgrab|scrapy|libwww-perl|go-http-client|xfa1) 1;
}
