{
    "description": "CK8S VM based on Ubuntu 18.04 LTS",
    "builders": [
      {
        "name": "baseos",
        "type": "qemu",
        "accelerator": "kvm",
        "vm_name": "{{ user `output_vm_name` }}",
        "format": "qcow2",
        "iso_url": "{{ user `source_iso_url` }}",
        "iso_checksum": "{{ user `source_iso_checksum` }}",
        "iso_checksum_type": "sha256",
        "disk_image": true,
        "disk_size": "{{ user `disk_size`}}",
        "disk_interface": "virtio-scsi",
        "disk_discard": "unmap",
        "disk_compression": true,
        "skip_compaction": false,
        "headless": true,
        "ssh_username": "{{ user `ssh_username` }}",
        "ssh_private_key_file": "ssh_keys/id_rsa_packer",
        "ssh_port": 22,
        "ssh_wait_timeout": "10000s",
        "shutdown_command": "echo 'shutdown -P now' > /tmp/shutdown.sh; sudo -S sh '/tmp/shutdown.sh'",
        "http_directory": "cloud-init/baseos",
        "http_port_min": 9000,
        "http_port_max": 9100,
        "vnc_bind_address": "0.0.0.0",
        "vnc_port_min": 5900,
        "vnc_port_max": 5900,
        "qemuargs": [
          [ "-m", "512M" ],
          [ "-smp", "2" ],
          [ "-smbios", "type=1,serial=ds=nocloud-net;instance-id=packer;seedfrom=http://{{ .HTTPIP }}:{{ .HTTPPort }}/" ]
        ]
      }
    ]
}