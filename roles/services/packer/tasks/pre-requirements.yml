---
- name: 'pre-requirements: Base Package Installation - using apt to use apt-get update'
  apt:
    state: "{{ item.state | default ('present') }}"
    name: "{{ item.name }}"
    update_cache: yes
  loop: "{{ base_packages }}"

- name: 'pre-requirements: Packer host specific packages'
  package:
    state: "{{ item.state | default ('present') }}"
    name: "{{ item.name }}"
  loop: "{{ packer_packages }}"

- name: 'pre-requirements: Create a packer user that has access to kvm'
  user:
    name: "{{ packer_user }}"
    groups: "kvm"
    create_home: False

- name: 'pre-requirements: Create the location for images'
  file:
    path: "{{ packer_file_location }}"
    state: directory
    owner: "{{ packer_user }}"
    mode: '0750'
